<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Career Pilot - Log In</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
    <link
      href="https://fonts.googleapis.com/css2?family=Work+Sans:ital,wght@0,100..900;1,100..900&amp;display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined"
      rel="stylesheet"
    />
     <script>
        function redirectToDevicePage() {
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            
            if (isMobile) {
                window.location.href = 'registermobile.html';
            } 
        }
        
        // Redirect on page load
        window.onload = redirectToDevicePage;
    </script>
    <script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              primary: "#13a4ec",
              "background-light": "#f6f7f8",
              "background-dark": "#101c22",
            },
            fontFamily: {
              display: ["Work Sans", "sans-serif"],
            },
            borderRadius: {
              DEFAULT: "0.25rem",
              lg: "0.5rem",
              xl: "0.75rem",
              full: "9999px",
            },
          },
        },
      };
    </script>
  </head>
  <body
    class="font-display bg-background-light dark:bg-background-dark text-black dark:text-white"
  >
    <div class="flex flex-col min-h-screen">
      <header
        class="flex items-center justify-between px-6 sm:px-10 py-4 border-b border-black/10 dark:border-white/10"
      >
        <div class="flex items-center gap-3">
          <div class="w-8 h-8 text-primary">
            <svg
              fill="none"
              viewBox="0 0 48 48"
              xmlns="http://www.w3.org/2000/svg"
            >
              <g clip-path="url(#clip0_6_330)">
                <path
                  clip-rule="evenodd"
                  d="M24 0.757355L47.2426 24L24 47.2426L0.757355 24L24 0.757355ZM21 35.7574V12.2426L9.24264 24L21 35.7574Z"
                  fill="currentColor"
                  fill-rule="evenodd"
                ></path>
              </g>
              <defs>
                <clipPath id="clip0_6_330">
                  <rect fill="white" height="48" width="48"></rect>
                </clipPath>
              </defs>
            </svg>
          </div>
          <h1 class="text-xl font-bold">Career Pilot</h1>
        </div>
        <nav class="hidden md:flex items-center gap-8">
          <a
            class="text-sm font-medium hover:text-primary transition-colors"
            href="#"
            >Home</a
          >
          <a
            class="text-sm font-medium hover:text-primary transition-colors"
            href="#"
            >Features</a
          >
          <a
            class="text-sm font-medium hover:text-primary transition-colors"
            href="#"
            >Pricing</a
          >
          <a
            class="text-sm font-medium hover:text-primary transition-colors"
            href="#"
            >Contact</a
          >
        </nav>
        <button class="md:hidden">
          <span class="material-symbols-outlined"> menu </span>
        </button>
      </header>
      <main class="flex-grow flex items-center justify-center p-4 sm:p-6">
        <div
          class="w-full max-w-md bg-white dark:bg-black/20 rounded-lg shadow-sm p-8"
        >
          <div class="text-center">
            <h2 class="text-2xl sm:text-3xl font-bold">Welcome Back</h2>
            <p class="text-black/60 dark:text-white/60 mt-2">
              Log in to access your dashboard.
            </p>
          </div>
          
          <!-- Error/Success Messages -->
          <div id="message" class="mt-4 p-3 rounded-lg hidden"></div>
          
          <form id="loginForm" class="mt-8 space-y-6">
            <div class="space-y-2">
              <label class="text-sm font-medium" for="email">Email</label>
              <input
                autocomplete="email"
                class="w-full px-4 py-3 rounded-lg bg-background-light dark:bg-background-dark border border-black/10 dark:border-white/10 focus:outline-none focus:ring-2 focus:ring-primary"
                id="email"
                name="email"
                placeholder="you@example.com"
                required=""
                type="email"
              />
            </div>
            <div class="space-y-2">
              <div class="flex items-center justify-between">
                <label class="text-sm font-medium" for="password"
                  >Password</label
                >
                <a
                  class="text-sm font-medium text-primary hover:underline"
                  href="#"
                  >Forgot password?</a
                >
              </div>
              <input
                autocomplete="current-password"
                class="w-full px-4 py-3 rounded-lg bg-background-light dark:bg-background-dark border border-black/10 dark:border-white/10 focus:outline-none focus:ring-2 focus:ring-primary"
                id="password"
                name="password"
                placeholder="••••••••"
                required=""
                type="password"
              />
            </div>
            <div>
              <button
                id="loginBtn"
                class="w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-bold text-white bg-primary hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:opacity-50"
                type="submit"
              >
                Log In
              </button>
            </div>
          </form>
          <div class="mt-6">
            <div class="relative">
              <div class="absolute inset-0 flex items-center">
                <div
                  class="w-full border-t border-black/10 dark:border-white/10"
                ></div>
              </div>
              <div class="relative flex justify-center text-sm">
                <span
                  class="px-2 bg-white dark:bg-[#1C2930] text-black/60 dark:text-white/60"
                  >Or continue with</span
                >
              </div>
            </div>
            <div class="mt-6 grid grid-cols-1 sm:grid-cols-2 gap-3">
              <a
                class="w-full flex items-center justify-center px-4 py-3 border border-black/10 dark:border-white/10 rounded-lg shadow-sm bg-white dark:bg-black/20 hover:bg-primary/10 dark:hover:bg-primary/20 transition-colors"
                href="http://localhost:4000/api/oauth/google"
              >
                <img
                  alt=""
                  class="h-5 w-5"
                  src="https://lh3.googleusercontent.com/aida-public/AB6AXuDdxeqeA4_ImNGUjQD20GMYQOmwv1m1QB1FWMU-OtKn1-0_osE6YKfcRhfk8diYEbOtgD0PKC0enEk7fcogYY03i82C4zAWJAys6y2MdlJ7NZiaWJrkmSZoy8NB4WhufX90Ykgt6yy2UnLZDdjp7uF3RdDufHNBJFzwqUhNnrdLzFf1shJ_XboQbu2VqdyFQeAzdsG6tHSzxv8KAoGuX-Miqpvf0eMAxjYSn3_cgIZ0HkFDlfRdyki-JnmzBjg6I_ZcPBL03Rc5cQ"
                />
                <span class="ml-3 text-sm font-medium">Google</span>
              </a>
              <a
                class="w-full flex items-center justify-center px-4 py-3 border border-black/10 dark:border-white/10 rounded-lg shadow-sm bg-white dark:bg-black/20 hover:bg-primary/10 dark:hover:bg-primary/20 transition-colors"
                href="http://localhost:4000/api/oauth/github"
              >
                <svg class="h-5 w-5" viewBox="0 0 24 24" fill="#333">
                  <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                </svg>
                <span class="ml-3 text-sm font-medium">GitHub</span>
              </a>
            </div>
          </div>
          <p class="mt-8 text-center text-sm text-black/60 dark:text-white/60">
            Don't have an account?
            <a class="font-medium text-primary hover:underline" href="/public/auth/signup.html"
              >Sign up</a
            >
          </p>
        </div>
      </main>
      <footer
        class="px-6 sm:px-10 py-6 border-t border-black/10 dark:border-white/10"
      >
        <div
          class="flex flex-col sm:flex-row justify-between items-center text-sm text-black/60 dark:text-white/60"
        >
          <p>© 2024 Career Pilot. All rights reserved Sole property of Dada David.</p>
          <div class="flex gap-6 mt-4 sm:mt-0">
            <a class="hover:text-primary transition-colors" href="#"
              >Terms of Service</a
            >
            <a class="hover:text-primary transition-colors" href="#"
              >Privacy Policy</a
            >
          </div>
        </div>
      </footer>
    </div>
    
    <script>
      const API_BASE_URL = 'http://localhost:4000/api'; 
      
      document.getElementById('loginForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;
        const loginBtn = document.getElementById('loginBtn');
        const messageDiv = document.getElementById('message');
        
        // Show loading state
        loginBtn.disabled = true;
        loginBtn.textContent = 'Logging in...';
        
        try {
          const response = await fetch(`${API_BASE_URL}/auth/login`, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({ email, password }),
          });
          
          const data = await response.json();
          
          if (response.ok) {
            // Success - store token and redirect
            localStorage.setItem('token', data.token);
            localStorage.setItem('user', JSON.stringify(data.user));
            
            showMessage('Login successful! Redirecting...', 'success');
            
            // Redirect to dashboard after 1 second
            setTimeout(() => {
              window.location.href = '/public/resume/resume.html'; // Adjust path as needed
            }, 1000);
          } else {
            // Error
            showMessage(data.msg || 'Login failed', 'error');
          }
        } catch (error) {
          console.error('Login error:', error);
          showMessage('Network error. Please try again.', 'error');
        } finally {
          // Reset button
          loginBtn.disabled = false;
          loginBtn.textContent = 'Log In';
        }
      });
      
      function showMessage(message, type) {
        const messageDiv = document.getElementById('message');
        messageDiv.textContent = message;
        messageDiv.className = `mt-4 p-3 rounded-lg ${
          type === 'success' 
            ? 'bg-green-100 text-green-700 border border-green-300' 
            : 'bg-red-100 text-red-700 border border-red-300'
        }`;
        messageDiv.classList.remove('hidden');
        
        // Hide message after 5 seconds
        setTimeout(() => {
          messageDiv.classList.add('hidden');
        }, 5000);
      }
    </script>
  </body>
</html>
